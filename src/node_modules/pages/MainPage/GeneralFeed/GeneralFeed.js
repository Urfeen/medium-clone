import React, { useState, useEffect } from 'react';
import Feed from "components/Feed/Feed";
import { projectDB } from "firebaseConfig/firebaseConfig.js";
import Button from '@material-ui/core/Button';
import moment from 'moment';

const GeneralFeed = (props) => {
  const { currentLang } = props;
  const [articles, setArticles] = useState(null);
  const [articlesAmount, setArticlesAmount] = useState(3);

  // React.useEffect(() => {
  //   const callback = projectDB.ref('/articles/').limitToLast(articlesAmount).on('value', (snapshot) => {
  //     const data = snapshot.val();
  //     console.log(getArticlesInfo(data));
  //     setArticles(getArticlesInfo(data));
  //   })
  //   console.log(callback);
  //   return () => { callback() };
  // }, [articlesAmount])

  // const getArticlesInfo = (data) => {
  //   const articles = [];
  //   Object.entries(data).reverse().map(e => {
  //     articles.push({ publishedDate: moment(new Date(+e[0])).format("DD.MM.YYYY") });
  //     return Object.entries(e[1])[0];
  //   }).forEach((e, i) => {
  //     articles[i].articleOwner = e[0];
  //     for (let articleContent in e[1]) articles[i][articleContent] = e[1][articleContent];
  //   })
  //   return articles;
  // }

  return (
    <div style={{ display: "grid", gap: "15px" }}>
      <Feed currentLang={currentLang} />
      { articles ? "Recieved" : "Loading"}
      <Button variant="outlined" onClick={() => { setArticlesAmount(prev => prev + 3) }}>+</Button>
    </div>
  );
}

export default GeneralFeed;